# 原根
> 推荐阅读 《训练指南》(蓝书) 

对于整数 $m$, 如果存在整数 $a$ $(1 \leq a < m)$ 使得 $a^{1}, a^{2}, a^{3}..., a^{m - 1}$ 模 $m$ 的值取遍 $1, 2, ..., m - 1$。那么 $a$ 就是 $m$ 的一个原根。

## 性质
1. $a^{1}, a^{2}, a^{3}...$ 模 $m$ 的取值会出现循环，根据欧拉定理， $a^{\varphi(m)} \equiv 1 \quad(\bmod m)$, 当 $m$ 是质数时， $a^{m - 1} \equiv 1 \quad(\bmod m)$，所以在出现 $1$ 之前不会有循环。出现 $1$ 后立刻开始循环。即原根循环节长度是 $m - 1$。
2. 原根有 $\varphi(\varphi(m))$ 个。
3. **原根不只是质数才有**， $2,4, p^{n}, 2 p^{n}$ ( $p$ 是奇质数) 都有原根。
4. 一个数的最小原根不多于 $m ^ {0.25}$ 级别。
5. 一个数的原根一定与它互质，因为不互质就没有循环节了。

## 求一个数 $m$ 的最小原根

方法:
1. 从小到大暴力枚举 $i$，判断 $i$ 是不是原根。
2. 判断一个数 $i$ 是不是 $m$ 的原根：
	1. 判断 $gcd(i, m)$ 是否等于 $1$. (原根和 $m$ 必须互质)
	2. 枚举 $\varphi(m)$ 的每一个真因子 $j$，如果 $i^{j} \equiv 1 \quad(\bmod m)$, 那么 $i$ 不是原根。(说明循环节小了)
	3. 实际上只需要枚举质因子就可以得到所有真因子的倍数。

## 求一个数 $m$ 的所有原根

原理：假设最小原根是 $g$, 一个数的所有原根都是 $g^k$ 形式。并且需要满足 $\gcd(k, \varphi(m)) = 1$ (由此可以知道原根有 $\varphi(\varphi(m))$ 个)

方法:
1. 求出最小原根 $g$。
2. 枚举 $k$ $(1\leq k \leq \varphi(m))$, 如果 $\gcd(k, \varphi(m)) = 1$， 那么 $g^{k} \% m$ 就是一个原根。 
		

